#!/usr/bin/env sh



# exit if error happens
set -e



# go to docker
script_dir="$( cd "$(dirname "$0")" ; pwd -P )"
cd "$script_dir"
cd "../docker"



# load environment
. ../.env



# before up

# prepare arguments
arguments=""

if [ "$APP_MODE" = "production" ]
then
	arguments="--no-dev --optimize-autoloader"
fi

# install dependencies
docker run --rm --interactive --tty --volume "$PWD/../:/app" composer install --no-ansi  --no-interaction --no-plugins --no-progress --no-scripts --ignore-platform-reqs $arguments



# compose
docker-compose \
  --env-file ../.env \
  --project-name mojeklima \
  up \
  --detach \
  --build
